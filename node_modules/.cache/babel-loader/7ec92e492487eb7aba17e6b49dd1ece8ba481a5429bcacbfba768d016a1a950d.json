{"ast":null,"code":"import React,{useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function hash(str){// Simple hash for demo (not cryptographically secure)\nlet hash=0;for(let i=0;i<str.length;i++){hash=(hash<<5)-hash+str.charCodeAt(i);hash|=0;}return hash.toString();}export default function PasswordGate(_ref){let{onUnlock}=_ref;const[username,setUsername]=useState(()=>localStorage.getItem(\"diary_last_user\")||\"\");const[step,setStep]=useState(null);const[pw,setPw]=useState(\"\");const[error,setError]=useState(\"\");// Check if user exists when username changes\nReact.useEffect(()=>{if(!username){setStep(null);return;}const userHash=localStorage.getItem(\"diary_pw_hash_\"+username);setStep(userHash?\"enter\":\"set\");},[username]);function handleSet(e){e.preventDefault();if(pw.length<4){setError(\"Password must be at least 4 characters.\");return;}localStorage.setItem(\"diary_pw_hash_\"+username,hash(pw));localStorage.setItem(\"diary_last_user\",username);setStep(\"enter\");setPw(\"\");setError(\"\");}function handleEnter(e){e.preventDefault();const stored=localStorage.getItem(\"diary_pw_hash_\"+username);if(hash(pw)===stored){setError(\"\");sessionStorage.setItem(\"diary_user\",username);localStorage.setItem(\"diary_last_user\",username);onUnlock();}else{setError(\"Incorrect password.\");}}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-100 via-blue-100 to-purple-100\",children:[/*#__PURE__*/_jsxs(\"form\",{className:\"bg-white/90 rounded-3xl shadow-xl p-10 w-full max-w-sm mx-auto flex flex-col items-center border-2 border-pink-200\",onSubmit:step===\"set\"?handleSet:handleEnter,children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-5xl mb-2 text-pink-400 text-center\",children:\"\\uD83D\\uDD12\\u2728\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold mb-4 text-blue-500 text-center font-cursive tracking-wide\",children:step===null?\"Welcome!\":step===\"set\"?\"Set a Password\":\"Enter Password\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 text-purple-500 text-center text-base font-cursive\",children:[\"Welcome to \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-pink-400\",children:\"DiaryMe\"}),\"!\",/*#__PURE__*/_jsx(\"br\",{}),\"Your private, cute diary app.\",/*#__PURE__*/_jsx(\"br\",{}),\"Set a password to keep your notes safe and secret. \\uD83D\\uDC96\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"w-full p-3 border-2 border-blue-200 rounded-xl mb-4 text-lg focus:outline-none focus:ring-2 focus:ring-pink-300 bg-blue-50 placeholder-pink-300 font-cursive\",placeholder:\"Username\",value:username,onChange:e=>setUsername(e.target.value),autoFocus:true}),step&&/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"w-full p-3 border-2 border-pink-200 rounded-xl mb-4 text-lg focus:outline-none focus:ring-2 focus:ring-blue-300 bg-pink-50 placeholder-blue-300 font-cursive\",placeholder:\"Password\",value:pw,onChange:e=>setPw(e.target.value)}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-red-400 mb-2 text-center font-bold font-cursive\",children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full bg-gradient-to-r from-pink-400 via-blue-400 to-purple-400 text-white py-3 rounded-xl font-extrabold text-lg shadow hover:scale-105 transition-transform duration-200\",disabled:!username||step&&!pw,children:step===null?\"Next\":step===\"set\"?\"Set Password\":\"Unlock\"})]}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n        .font-cursive { font-family: 'Comic Sans MS', 'Comic Sans', cursive; }\\n      \"})]});}","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","hash","str","i","length","charCodeAt","toString","PasswordGate","_ref","onUnlock","username","setUsername","localStorage","getItem","step","setStep","pw","setPw","error","setError","useEffect","userHash","handleSet","e","preventDefault","setItem","handleEnter","stored","sessionStorage","className","children","onSubmit","type","placeholder","value","onChange","target","autoFocus","disabled"],"sources":["D:/diary me test/src/PasswordGate.js"],"sourcesContent":["import React, { useState } from \"react\";\n\nfunction hash(str) {\n  // Simple hash for demo (not cryptographically secure)\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = ((hash << 5) - hash) + str.charCodeAt(i);\n    hash |= 0;\n  }\n  return hash.toString();\n}\n\nexport default function PasswordGate({ onUnlock }) {\n  const [username, setUsername] = useState(() => localStorage.getItem(\"diary_last_user\") || \"\");\n  const [step, setStep] = useState(null);\n  const [pw, setPw] = useState(\"\");\n  const [error, setError] = useState(\"\");\n\n  // Check if user exists when username changes\n  React.useEffect(() => {\n    if (!username) {\n      setStep(null);\n      return;\n    }\n    const userHash = localStorage.getItem(\"diary_pw_hash_\" + username);\n    setStep(userHash ? \"enter\" : \"set\");\n  }, [username]);\n\n  function handleSet(e) {\n    e.preventDefault();\n    if (pw.length < 4) {\n      setError(\"Password must be at least 4 characters.\");\n      return;\n    }\n  localStorage.setItem(\"diary_pw_hash_\" + username, hash(pw));\n  localStorage.setItem(\"diary_last_user\", username);\n  setStep(\"enter\");\n  setPw(\"\");\n  setError(\"\");\n  }\n\n  function handleEnter(e) {\n    e.preventDefault();\n    const stored = localStorage.getItem(\"diary_pw_hash_\" + username);\n    if (hash(pw) === stored) {\n      setError(\"\");\n      sessionStorage.setItem(\"diary_user\", username);\n      localStorage.setItem(\"diary_last_user\", username);\n      onUnlock();\n    } else {\n      setError(\"Incorrect password.\");\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-100 via-blue-100 to-purple-100\">\n      <form className=\"bg-white/90 rounded-3xl shadow-xl p-10 w-full max-w-sm mx-auto flex flex-col items-center border-2 border-pink-200\" onSubmit={step === \"set\" ? handleSet : handleEnter}>\n        <div className=\"text-5xl mb-2 text-pink-400 text-center\">ðŸ”’âœ¨</div>\n        <h2 className=\"text-3xl font-extrabold mb-4 text-blue-500 text-center font-cursive tracking-wide\">\n          {step === null ? \"Welcome!\" : step === \"set\" ? \"Set a Password\" : \"Enter Password\"}\n        </h2>\n        <div className=\"mb-4 text-purple-500 text-center text-base font-cursive\">\n          Welcome to <span className=\"font-bold text-pink-400\">DiaryMe</span>!<br />Your private, cute diary app.<br />Set a password to keep your notes safe and secret. ðŸ’–\n        </div>\n        <input\n          type=\"text\"\n          className=\"w-full p-3 border-2 border-blue-200 rounded-xl mb-4 text-lg focus:outline-none focus:ring-2 focus:ring-pink-300 bg-blue-50 placeholder-pink-300 font-cursive\"\n          placeholder=\"Username\"\n          value={username}\n          onChange={e => setUsername(e.target.value)}\n          autoFocus\n        />\n        {step && (\n          <input\n            type=\"password\"\n            className=\"w-full p-3 border-2 border-pink-200 rounded-xl mb-4 text-lg focus:outline-none focus:ring-2 focus:ring-blue-300 bg-pink-50 placeholder-blue-300 font-cursive\"\n            placeholder=\"Password\"\n            value={pw}\n            onChange={e => setPw(e.target.value)}\n          />\n        )}\n        {error && <div className=\"text-red-400 mb-2 text-center font-bold font-cursive\">{error}</div>}\n        <button type=\"submit\" className=\"w-full bg-gradient-to-r from-pink-400 via-blue-400 to-purple-400 text-white py-3 rounded-xl font-extrabold text-lg shadow hover:scale-105 transition-transform duration-200\" disabled={!username || (step && !pw)}>\n          {step === null ? \"Next\" : step === \"set\" ? \"Set Password\" : \"Unlock\"}\n        </button>\n      </form>\n      <style>{`\n        .font-cursive { font-family: 'Comic Sans MS', 'Comic Sans', cursive; }\n      `}</style>\n    </div>\n  );\n}\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExC,QAAS,CAAAC,IAAIA,CAACC,GAAG,CAAE,CACjB;AACA,GAAI,CAAAD,IAAI,CAAG,CAAC,CACZ,IAAK,GAAI,CAAAE,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGD,GAAG,CAACE,MAAM,CAAED,CAAC,EAAE,CAAE,CACnCF,IAAI,CAAI,CAACA,IAAI,EAAI,CAAC,EAAIA,IAAI,CAAIC,GAAG,CAACG,UAAU,CAACF,CAAC,CAAC,CAC/CF,IAAI,EAAI,CAAC,CACX,CACA,MAAO,CAAAA,IAAI,CAACK,QAAQ,CAAC,CAAC,CACxB,CAEA,cAAe,SAAS,CAAAC,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC/C,KAAM,CAACE,QAAQ,CAAEC,WAAW,CAAC,CAAGf,QAAQ,CAAC,IAAMgB,YAAY,CAACC,OAAO,CAAC,iBAAiB,CAAC,EAAI,EAAE,CAAC,CAC7F,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGnB,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACoB,EAAE,CAAEC,KAAK,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CAChC,KAAM,CAACsB,KAAK,CAAEC,QAAQ,CAAC,CAAGvB,QAAQ,CAAC,EAAE,CAAC,CAEtC;AACAD,KAAK,CAACyB,SAAS,CAAC,IAAM,CACpB,GAAI,CAACV,QAAQ,CAAE,CACbK,OAAO,CAAC,IAAI,CAAC,CACb,OACF,CACA,KAAM,CAAAM,QAAQ,CAAGT,YAAY,CAACC,OAAO,CAAC,gBAAgB,CAAGH,QAAQ,CAAC,CAClEK,OAAO,CAACM,QAAQ,CAAG,OAAO,CAAG,KAAK,CAAC,CACrC,CAAC,CAAE,CAACX,QAAQ,CAAC,CAAC,CAEd,QAAS,CAAAY,SAASA,CAACC,CAAC,CAAE,CACpBA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,GAAIR,EAAE,CAACZ,MAAM,CAAG,CAAC,CAAE,CACjBe,QAAQ,CAAC,yCAAyC,CAAC,CACnD,OACF,CACFP,YAAY,CAACa,OAAO,CAAC,gBAAgB,CAAGf,QAAQ,CAAET,IAAI,CAACe,EAAE,CAAC,CAAC,CAC3DJ,YAAY,CAACa,OAAO,CAAC,iBAAiB,CAAEf,QAAQ,CAAC,CACjDK,OAAO,CAAC,OAAO,CAAC,CAChBE,KAAK,CAAC,EAAE,CAAC,CACTE,QAAQ,CAAC,EAAE,CAAC,CACZ,CAEA,QAAS,CAAAO,WAAWA,CAACH,CAAC,CAAE,CACtBA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,KAAM,CAAAG,MAAM,CAAGf,YAAY,CAACC,OAAO,CAAC,gBAAgB,CAAGH,QAAQ,CAAC,CAChE,GAAIT,IAAI,CAACe,EAAE,CAAC,GAAKW,MAAM,CAAE,CACvBR,QAAQ,CAAC,EAAE,CAAC,CACZS,cAAc,CAACH,OAAO,CAAC,YAAY,CAAEf,QAAQ,CAAC,CAC9CE,YAAY,CAACa,OAAO,CAAC,iBAAiB,CAAEf,QAAQ,CAAC,CACjDD,QAAQ,CAAC,CAAC,CACZ,CAAC,IAAM,CACLU,QAAQ,CAAC,qBAAqB,CAAC,CACjC,CACF,CAEA,mBACEnB,KAAA,QAAK6B,SAAS,CAAC,0GAA0G,CAAAC,QAAA,eACvH9B,KAAA,SAAM6B,SAAS,CAAC,oHAAoH,CAACE,QAAQ,CAAEjB,IAAI,GAAK,KAAK,CAAGQ,SAAS,CAAGI,WAAY,CAAAI,QAAA,eACtLhC,IAAA,QAAK+B,SAAS,CAAC,yCAAyC,CAAAC,QAAA,CAAC,oBAAG,CAAK,CAAC,cAClEhC,IAAA,OAAI+B,SAAS,CAAC,mFAAmF,CAAAC,QAAA,CAC9FhB,IAAI,GAAK,IAAI,CAAG,UAAU,CAAGA,IAAI,GAAK,KAAK,CAAG,gBAAgB,CAAG,gBAAgB,CAChF,CAAC,cACLd,KAAA,QAAK6B,SAAS,CAAC,yDAAyD,CAAAC,QAAA,EAAC,aAC5D,cAAAhC,IAAA,SAAM+B,SAAS,CAAC,yBAAyB,CAAAC,QAAA,CAAC,SAAO,CAAM,CAAC,IAAC,cAAAhC,IAAA,QAAK,CAAC,gCAA6B,cAAAA,IAAA,QAAK,CAAC,kEAC/G,EAAK,CAAC,cACNA,IAAA,UACEkC,IAAI,CAAC,MAAM,CACXH,SAAS,CAAC,8JAA8J,CACxKI,WAAW,CAAC,UAAU,CACtBC,KAAK,CAAExB,QAAS,CAChByB,QAAQ,CAAEZ,CAAC,EAAIZ,WAAW,CAACY,CAAC,CAACa,MAAM,CAACF,KAAK,CAAE,CAC3CG,SAAS,MACV,CAAC,CACDvB,IAAI,eACHhB,IAAA,UACEkC,IAAI,CAAC,UAAU,CACfH,SAAS,CAAC,8JAA8J,CACxKI,WAAW,CAAC,UAAU,CACtBC,KAAK,CAAElB,EAAG,CACVmB,QAAQ,CAAEZ,CAAC,EAAIN,KAAK,CAACM,CAAC,CAACa,MAAM,CAACF,KAAK,CAAE,CACtC,CACF,CACAhB,KAAK,eAAIpB,IAAA,QAAK+B,SAAS,CAAC,sDAAsD,CAAAC,QAAA,CAAEZ,KAAK,CAAM,CAAC,cAC7FpB,IAAA,WAAQkC,IAAI,CAAC,QAAQ,CAACH,SAAS,CAAC,6KAA6K,CAACS,QAAQ,CAAE,CAAC5B,QAAQ,EAAKI,IAAI,EAAI,CAACE,EAAI,CAAAc,QAAA,CAChPhB,IAAI,GAAK,IAAI,CAAG,MAAM,CAAGA,IAAI,GAAK,KAAK,CAAG,cAAc,CAAG,QAAQ,CAC9D,CAAC,EACL,CAAC,cACPhB,IAAA,UAAAgC,QAAA,4FAES,CAAC,EACP,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}