{"ast":null,"code":"import ExportButtons from'./ExportButtons';import BuyMeACoffee from'./BuyMeACoffee';import DiaryEditor from'./DiaryEditor';import React from'react';import{useParams,useNavigate,useLocation}from'react-router-dom';import{getDiaryEntriesFromSupabase}from'../dbSupabase';import{useSupabaseUser}from'../useSupabaseUser';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function EntryPage(){const{id}=useParams();const navigate=useNavigate();const location=useLocation();const[entry,setEntry]=React.useState(null);const[editing,setEditing]=React.useState(false);const user=useSupabaseUser();React.useEffect(()=>{if(user&&user.id){getDiaryEntriesFromSupabase(user.id).then(_ref=>{let{data}=_ref;const found=(data||[]).find(e=>String(e.id)===String(id));setEntry(found||null);});}},[id,user]);React.useEffect(()=>{if(location.search.includes('edit=true')){setEditing(true);}},[location.search]);if(!entry){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded shadow p-10 text-center w-full max-w-3xl mx-auto text-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-base text-gray-700\",children:\"Entry not found.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"mt-4 px-4 py-2 bg-blue-600 text-white rounded shadow\",onClick:()=>navigate(-1),children:\"Go Back\"})]})});}if(editing){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded shadow p-10 w-full max-w-3xl mx-auto relative text-lg\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"absolute top-2 right-2 text-red-500 font-bold text-2xl hover:text-red-700\",onClick:()=>setEditing(false),children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4 text-blue-700 text-center\",children:\"Edit Entry\"}),/*#__PURE__*/_jsx(DiaryEditor,{initialEntry:entry,onSave:()=>{setEditing(false);navigate(0);}})]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded shadow p-10 w-full max-w-3xl mx-auto relative text-lg\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"absolute top-2 right-2 text-red-500 font-bold text-2xl hover:text-red-700\",onClick:()=>navigate(-1),children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-4xl font-bold mb-4 text-blue-700 text-center\",children:entry.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 text-lg text-gray-500 text-center\",children:[entry.date,\" \",entry.mood&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-2xl\",children:entry.mood})]}),entry.tags&&entry.tags.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 text-base bg-blue-100 px-3 py-2 rounded text-gray-700 inline-block font-bold text-center\",children:entry.tags.join(', ')}),entry.image&&/*#__PURE__*/_jsx(\"img\",{src:entry.image,alt:\"Diary\",className:\"my-6 max-h-80 rounded mx-auto\"}),/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-lg max-w-none bg-gray-50 p-6 rounded border border-gray-200 text-gray-900 text-center\",dangerouslySetInnerHTML:{__html:entry.content}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center mt-4 gap-2\",children:[/*#__PURE__*/_jsx(ExportButtons,{entry:entry}),/*#__PURE__*/_jsx(\"button\",{className:\"bg-blue-600 text-white px-3 py-1 rounded shadow text-sm font-semibold\",onClick:()=>{navigator.clipboard.writeText(window.location.href);alert('Entry link copied! You can share it, but only you can view it on this device.');},children:\"Share Entry\"}),/*#__PURE__*/_jsx(\"button\",{className:\"bg-green-600 text-white px-3 py-1 rounded shadow text-sm font-semibold\",onClick:()=>setEditing(true),children:\"Edit Entry\"}),/*#__PURE__*/_jsx(BuyMeACoffee,{inline:true})]})]})});}export default EntryPage;","map":{"version":3,"names":["ExportButtons","BuyMeACoffee","DiaryEditor","React","useParams","useNavigate","useLocation","getDiaryEntriesFromSupabase","useSupabaseUser","jsx","_jsx","jsxs","_jsxs","EntryPage","id","navigate","location","entry","setEntry","useState","editing","setEditing","user","useEffect","then","_ref","data","found","find","e","String","search","includes","className","children","onClick","initialEntry","onSave","title","date","mood","tags","length","join","image","src","alt","dangerouslySetInnerHTML","__html","content","navigator","clipboard","writeText","window","href","alert","inline"],"sources":["D:/diary me test/src/components/EntryPage.js"],"sourcesContent":["import ExportButtons from './ExportButtons';\r\nimport BuyMeACoffee from './BuyMeACoffee';\r\nimport DiaryEditor from './DiaryEditor';\r\nimport React from 'react';\r\nimport { useParams, useNavigate, useLocation } from 'react-router-dom';\r\nimport { getDiaryEntriesFromSupabase } from '../dbSupabase';\r\nimport { useSupabaseUser } from '../useSupabaseUser';\r\nfunction EntryPage() {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const [entry, setEntry] = React.useState(null);\r\n  const [editing, setEditing] = React.useState(false);\r\n  const user = useSupabaseUser();\r\n\r\n  React.useEffect(() => {\r\n    if (user && user.id) {\r\n      getDiaryEntriesFromSupabase(user.id).then(({ data }) => {\r\n        const found = (data || []).find(e => String(e.id) === String(id));\r\n        setEntry(found || null);\r\n      });\r\n    }\r\n  }, [id, user]);\r\n\r\n  React.useEffect(() => {\r\n    if (location.search.includes('edit=true')) {\r\n      setEditing(true);\r\n    }\r\n  }, [location.search]);\r\n\r\n  if (!entry) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"bg-white rounded shadow p-10 text-center w-full max-w-3xl mx-auto text-lg\">\r\n          <p className=\"text-base text-gray-700\">Entry not found.</p>\r\n          <button className=\"mt-4 px-4 py-2 bg-blue-600 text-white rounded shadow\" onClick={() => navigate(-1)}>Go Back</button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (editing) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"bg-white rounded shadow p-10 w-full max-w-3xl mx-auto relative text-lg\">\r\n          <button\r\n            className=\"absolute top-2 right-2 text-red-500 font-bold text-2xl hover:text-red-700\"\r\n            onClick={() => setEditing(false)}\r\n          >×</button>\r\n          <h2 className=\"text-xl font-bold mb-4 text-blue-700 text-center\">Edit Entry</h2>\r\n          <DiaryEditor\r\n            initialEntry={entry}\r\n            onSave={() => { setEditing(false); navigate(0); }}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center\">\r\n      <div className=\"bg-white rounded shadow p-10 w-full max-w-3xl mx-auto relative text-lg\">\r\n        <button\r\n          className=\"absolute top-2 right-2 text-red-500 font-bold text-2xl hover:text-red-700\"\r\n          onClick={() => navigate(-1)}\r\n        >×</button>\r\n  <h2 className=\"text-4xl font-bold mb-4 text-blue-700 text-center\">{entry.title}</h2>\r\n  <div className=\"mb-4 text-lg text-gray-500 text-center\">{entry.date} {entry.mood && <span className=\"ml-2 text-2xl\">{entry.mood}</span>}</div>\r\n        {entry.tags && entry.tags.length > 0 && (\r\n          <div className=\"mb-4 text-base bg-blue-100 px-3 py-2 rounded text-gray-700 inline-block font-bold text-center\">{entry.tags.join(', ')}</div>\r\n        )}\r\n  {entry.image && <img src={entry.image} alt=\"Diary\" className=\"my-6 max-h-80 rounded mx-auto\" />}\r\n  <div className=\"prose prose-lg max-w-none bg-gray-50 p-6 rounded border border-gray-200 text-gray-900 text-center\" dangerouslySetInnerHTML={{ __html: entry.content }} />\r\n        <div className=\"flex flex-col items-center mt-4 gap-2\">\r\n          <ExportButtons entry={entry} />\r\n          <button\r\n            className=\"bg-blue-600 text-white px-3 py-1 rounded shadow text-sm font-semibold\"\r\n            onClick={() => {\r\n              navigator.clipboard.writeText(window.location.href);\r\n              alert('Entry link copied! You can share it, but only you can view it on this device.');\r\n            }}\r\n          >\r\n            Share Entry\r\n          </button>\r\n          <button\r\n            className=\"bg-green-600 text-white px-3 py-1 rounded shadow text-sm font-semibold\"\r\n            onClick={() => setEditing(true)}\r\n          >\r\n            Edit Entry\r\n          </button>\r\n          <BuyMeACoffee inline />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EntryPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}