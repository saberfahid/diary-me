{"ast":null,"code":"import React,{useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function hash(str){// Simple hash for demo (not cryptographically secure)\nlet hash=0;for(let i=0;i<str.length;i++){hash=(hash<<5)-hash+str.charCodeAt(i);hash|=0;}return hash.toString();}export default function PasswordGate(_ref){let{onUnlock}=_ref;const[username,setUsername]=useState(\"\");const[step,setStep]=useState(null);const[pw,setPw]=useState(\"\");const[error,setError]=useState(\"\");// Check if user exists when username changes\nReact.useEffect(()=>{if(!username){setStep(null);return;}const userHash=localStorage.getItem(\"diary_pw_hash_\"+username);setStep(userHash?\"enter\":\"set\");},[username]);function handleSet(e){e.preventDefault();if(pw.length<4){setError(\"Password must be at least 4 characters.\");return;}localStorage.setItem(\"diary_pw_hash_\"+username,hash(pw));setStep(\"enter\");setPw(\"\");setError(\"\");}function handleEnter(e){e.preventDefault();const stored=localStorage.getItem(\"diary_pw_hash_\"+username);if(hash(pw)===stored){setError(\"\");sessionStorage.setItem(\"diary_user\",username);onUnlock();}else{setError(\"Incorrect password.\");}}return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-100\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"bg-white rounded shadow p-8 w-full max-w-sm mx-auto\",onSubmit:step===\"set\"?handleSet:handleEnter,children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-4 text-blue-700 text-center\",children:step===null?\"Enter Username\":step===\"set\"?\"Set a Password\":\"Enter Password\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 text-gray-600 text-center text-sm\",children:\"Welcome to DiaryMe! This app keeps your diary entries private and secure. Set a password to protect your notes. You will need your password each time you open the app.\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"w-full p-2 border rounded mb-4\",placeholder:\"Username\",value:username,onChange:e=>setUsername(e.target.value),autoFocus:true}),step&&/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"w-full p-2 border rounded mb-4\",placeholder:\"Password\",value:pw,onChange:e=>setPw(e.target.value)}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 mb-2 text-center\",children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full bg-blue-500 text-white py-2 rounded font-bold\",disabled:!username||step&&!pw,children:step===null?\"Next\":step===\"set\"?\"Set Password\":\"Unlock\"})]})});}","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","hash","str","i","length","charCodeAt","toString","PasswordGate","_ref","onUnlock","username","setUsername","step","setStep","pw","setPw","error","setError","useEffect","userHash","localStorage","getItem","handleSet","e","preventDefault","setItem","handleEnter","stored","sessionStorage","className","children","onSubmit","type","placeholder","value","onChange","target","autoFocus","disabled"],"sources":["D:/diary me test/src/PasswordGate.js"],"sourcesContent":["import React, { useState } from \"react\";\r\n\r\nfunction hash(str) {\r\n  // Simple hash for demo (not cryptographically secure)\r\n  let hash = 0;\r\n  for (let i = 0; i < str.length; i++) {\r\n    hash = ((hash << 5) - hash) + str.charCodeAt(i);\r\n    hash |= 0;\r\n  }\r\n  return hash.toString();\r\n}\r\n\r\nexport default function PasswordGate({ onUnlock }) {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [step, setStep] = useState(null);\r\n  const [pw, setPw] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n\r\n  // Check if user exists when username changes\r\n  React.useEffect(() => {\r\n    if (!username) {\r\n      setStep(null);\r\n      return;\r\n    }\r\n    const userHash = localStorage.getItem(\"diary_pw_hash_\" + username);\r\n    setStep(userHash ? \"enter\" : \"set\");\r\n  }, [username]);\r\n\r\n  function handleSet(e) {\r\n    e.preventDefault();\r\n    if (pw.length < 4) {\r\n      setError(\"Password must be at least 4 characters.\");\r\n      return;\r\n    }\r\n  localStorage.setItem(\"diary_pw_hash_\" + username, hash(pw));\r\n  setStep(\"enter\");\r\n  setPw(\"\");\r\n  setError(\"\");\r\n  }\r\n\r\n  function handleEnter(e) {\r\n    e.preventDefault();\r\n    const stored = localStorage.getItem(\"diary_pw_hash_\" + username);\r\n    if (hash(pw) === stored) {\r\n      setError(\"\");\r\n      sessionStorage.setItem(\"diary_user\", username);\r\n      onUnlock();\r\n    } else {\r\n      setError(\"Incorrect password.\");\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-100\">\r\n      <form className=\"bg-white rounded shadow p-8 w-full max-w-sm mx-auto\" onSubmit={step === \"set\" ? handleSet : handleEnter}>\r\n        <h2 className=\"text-2xl font-bold mb-4 text-blue-700 text-center\">\r\n          {step === null ? \"Enter Username\" : step === \"set\" ? \"Set a Password\" : \"Enter Password\"}\r\n        </h2>\r\n        <div className=\"mb-4 text-gray-600 text-center text-sm\">\r\n          Welcome to DiaryMe! This app keeps your diary entries private and secure. Set a password to protect your notes. You will need your password each time you open the app.\r\n        </div>\r\n        <input\r\n          type=\"text\"\r\n          className=\"w-full p-2 border rounded mb-4\"\r\n          placeholder=\"Username\"\r\n          value={username}\r\n          onChange={e => setUsername(e.target.value)}\r\n          autoFocus\r\n        />\r\n        {step && (\r\n          <input\r\n            type=\"password\"\r\n            className=\"w-full p-2 border rounded mb-4\"\r\n            placeholder=\"Password\"\r\n            value={pw}\r\n            onChange={e => setPw(e.target.value)}\r\n          />\r\n        )}\r\n        {error && <div className=\"text-red-500 mb-2 text-center\">{error}</div>}\r\n        <button type=\"submit\" className=\"w-full bg-blue-500 text-white py-2 rounded font-bold\" disabled={!username || (step && !pw)}>\r\n          {step === null ? \"Next\" : step === \"set\" ? \"Set Password\" : \"Unlock\"}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExC,QAAS,CAAAC,IAAIA,CAACC,GAAG,CAAE,CACjB;AACA,GAAI,CAAAD,IAAI,CAAG,CAAC,CACZ,IAAK,GAAI,CAAAE,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGD,GAAG,CAACE,MAAM,CAAED,CAAC,EAAE,CAAE,CACnCF,IAAI,CAAI,CAACA,IAAI,EAAI,CAAC,EAAIA,IAAI,CAAIC,GAAG,CAACG,UAAU,CAACF,CAAC,CAAC,CAC/CF,IAAI,EAAI,CAAC,CACX,CACA,MAAO,CAAAA,IAAI,CAACK,QAAQ,CAAC,CAAC,CACxB,CAEA,cAAe,SAAS,CAAAC,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC/C,KAAM,CAACE,QAAQ,CAAEC,WAAW,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACgB,IAAI,CAAEC,OAAO,CAAC,CAAGjB,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACkB,EAAE,CAAEC,KAAK,CAAC,CAAGnB,QAAQ,CAAC,EAAE,CAAC,CAChC,KAAM,CAACoB,KAAK,CAAEC,QAAQ,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CAEtC;AACAD,KAAK,CAACuB,SAAS,CAAC,IAAM,CACpB,GAAI,CAACR,QAAQ,CAAE,CACbG,OAAO,CAAC,IAAI,CAAC,CACb,OACF,CACA,KAAM,CAAAM,QAAQ,CAAGC,YAAY,CAACC,OAAO,CAAC,gBAAgB,CAAGX,QAAQ,CAAC,CAClEG,OAAO,CAACM,QAAQ,CAAG,OAAO,CAAG,KAAK,CAAC,CACrC,CAAC,CAAE,CAACT,QAAQ,CAAC,CAAC,CAEd,QAAS,CAAAY,SAASA,CAACC,CAAC,CAAE,CACpBA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,GAAIV,EAAE,CAACV,MAAM,CAAG,CAAC,CAAE,CACjBa,QAAQ,CAAC,yCAAyC,CAAC,CACnD,OACF,CACFG,YAAY,CAACK,OAAO,CAAC,gBAAgB,CAAGf,QAAQ,CAAET,IAAI,CAACa,EAAE,CAAC,CAAC,CAC3DD,OAAO,CAAC,OAAO,CAAC,CAChBE,KAAK,CAAC,EAAE,CAAC,CACTE,QAAQ,CAAC,EAAE,CAAC,CACZ,CAEA,QAAS,CAAAS,WAAWA,CAACH,CAAC,CAAE,CACtBA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,KAAM,CAAAG,MAAM,CAAGP,YAAY,CAACC,OAAO,CAAC,gBAAgB,CAAGX,QAAQ,CAAC,CAChE,GAAIT,IAAI,CAACa,EAAE,CAAC,GAAKa,MAAM,CAAE,CACvBV,QAAQ,CAAC,EAAE,CAAC,CACZW,cAAc,CAACH,OAAO,CAAC,YAAY,CAAEf,QAAQ,CAAC,CAC9CD,QAAQ,CAAC,CAAC,CACZ,CAAC,IAAM,CACLQ,QAAQ,CAAC,qBAAqB,CAAC,CACjC,CACF,CAEA,mBACEnB,IAAA,QAAK+B,SAAS,CAAC,2DAA2D,CAAAC,QAAA,cACxE9B,KAAA,SAAM6B,SAAS,CAAC,qDAAqD,CAACE,QAAQ,CAAEnB,IAAI,GAAK,KAAK,CAAGU,SAAS,CAAGI,WAAY,CAAAI,QAAA,eACvHhC,IAAA,OAAI+B,SAAS,CAAC,mDAAmD,CAAAC,QAAA,CAC9DlB,IAAI,GAAK,IAAI,CAAG,gBAAgB,CAAGA,IAAI,GAAK,KAAK,CAAG,gBAAgB,CAAG,gBAAgB,CACtF,CAAC,cACLd,IAAA,QAAK+B,SAAS,CAAC,wCAAwC,CAAAC,QAAA,CAAC,yKAExD,CAAK,CAAC,cACNhC,IAAA,UACEkC,IAAI,CAAC,MAAM,CACXH,SAAS,CAAC,gCAAgC,CAC1CI,WAAW,CAAC,UAAU,CACtBC,KAAK,CAAExB,QAAS,CAChByB,QAAQ,CAAEZ,CAAC,EAAIZ,WAAW,CAACY,CAAC,CAACa,MAAM,CAACF,KAAK,CAAE,CAC3CG,SAAS,MACV,CAAC,CACDzB,IAAI,eACHd,IAAA,UACEkC,IAAI,CAAC,UAAU,CACfH,SAAS,CAAC,gCAAgC,CAC1CI,WAAW,CAAC,UAAU,CACtBC,KAAK,CAAEpB,EAAG,CACVqB,QAAQ,CAAEZ,CAAC,EAAIR,KAAK,CAACQ,CAAC,CAACa,MAAM,CAACF,KAAK,CAAE,CACtC,CACF,CACAlB,KAAK,eAAIlB,IAAA,QAAK+B,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAAEd,KAAK,CAAM,CAAC,cACtElB,IAAA,WAAQkC,IAAI,CAAC,QAAQ,CAACH,SAAS,CAAC,sDAAsD,CAACS,QAAQ,CAAE,CAAC5B,QAAQ,EAAKE,IAAI,EAAI,CAACE,EAAI,CAAAgB,QAAA,CACzHlB,IAAI,GAAK,IAAI,CAAG,MAAM,CAAGA,IAAI,GAAK,KAAK,CAAG,cAAc,CAAG,QAAQ,CAC9D,CAAC,EACL,CAAC,CACJ,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}